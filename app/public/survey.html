<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>FriendFinder</title>

	<!-- Latest compiled and minified CSS & JS -->
	<script src="https://code.jquery.com/jquery.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" />

	<!-- font -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">

	<!-- css -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>

	<style>
		#yourImg,
		#matchImg {
			width: 100%;
		}

		.carousel-inner {
			background-color: grey;
			height: 375px;
		}

		.carousel-item {
			text-align: center;
			padding: 65px;
		}

		input, select,
		input:focus, select:focus {
			border: 0;
			box-shadow: 0 0 15px rgba(0, 38, 255, 1);
			outline: 0;
		}
		#submit {
			width: 300px;
			height: 200px;
		}

		.carousel-indicators li {
			transition: width .5s;
		}
		.carousel-indicators li.active {
			background-color: blue;
			width: 40px;
		}
	</style>
</head>

<body>

	<div class="container">
		<div class="row">
			<div class="col">
				<h2>Survey Questions</h2>
				<hr>


				<div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel" data-interval="false" data-wrap="false">
					<ol class="carousel-indicators">
						<li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
						<li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
						<li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
						<li data-target="#carouselExampleIndicators" data-slide-to="3"></li>
						<li data-target="#carouselExampleIndicators" data-slide-to="4"></li>
						<li data-target="#carouselExampleIndicators" data-slide-to="5"></li>
						<li data-target="#carouselExampleIndicators" data-slide-to="6"></li>
						<li data-target="#carouselExampleIndicators" data-slide-to="7"></li>
						<li data-target="#carouselExampleIndicators" data-slide-to="8"></li>
						<li data-target="#carouselExampleIndicators" data-slide-to="9"></li>
						<li data-target="#carouselExampleIndicators" data-slide-to="10"></li>
						<li data-target="#carouselExampleIndicators" data-slide-to="11"></li>
					</ol>
					<div class="carousel-inner">
						<div class="carousel-item active">
							<h3>
								<strong>About You</strong>
							</h3>
							<div class="row">
								<div class="col-4 offset-md-2">
										<h4>Name (required)</h4>
										<input type="text" name="" id="name" class="form-control-lg" required="">
								</div>
								<div class="col-4">
										<h4>Link to Photo (required)</h4>
										<input type="text" name="" id="photo" class="form-control-lg" required="">
								</div>
							</div>
							

							
						</div>
						<div class="carousel-item">
							<h3>
								<strong>Question 1</strong>
							</h3>
							<h4>You think about space often.</h4>
							<select data-placeholder class="form-control-lg" id="q1">
								<option value=""></option>
								<option value="1">1 (Strongly Disagree)</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5 (Strongly Agree)</option>
							</select>
						</div>
						<div class="carousel-item">
							<h3>
								<strong>Question 2</strong>
							</h3>
							<h4>You enjoy traveling to new places.</h4>
							<select data-placeholder="" class="form-control-lg" id="q2">
								<option value=""></option>
								<option value="1">1 (Strongly Disagree)</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5 (Strongly Agree)</option>
							</select>
						</div>
						<div class="carousel-item">
							<h3>
								<strong>Question 3</strong>
							</h3>
							<h4>You can talk to strangers easily.</h4>
							<select data-placeholder="" class="form-control-lg" id="q3">
								<option value=""></option>
								<option value="1">1 (Strongly Disagree)</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5 (Strongly Agree)</option>
							</select>
						</div>
						<div class="carousel-item">
							<h3>
								<strong>Question 4</strong>
							</h3>
							<h4>You seek out to have a lot of friends.</h4>
							<select data-placeholder="" class="form-control-lg" id="q4">
								<option value=""></option>
								<option value="1">1 (Strongly Disagree)</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5 (Strongly Agree)</option>
							</select>
						</div>
						<div class="carousel-item">
							<h3>
								<strong>Question 5</strong>
							</h3>
							<h4>You let your emotions get the better part of you.</h4>
							<select data-placeholder="" class="form-control-lg" id="q5">
								<option value=""></option>
								<option value="1">1 (Strongly Disagree)</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5 (Strongly Agree)</option>
							</select>
						</div>
						<div class="carousel-item">
							<h3>
								<strong>Question 6</strong>
							</h3>
							<h4>You enjoy long nights out at the bar.</h4>
							<select data-placeholder="" class="form-control-lg" id="q6">
								<option value=""></option>
								<option value="1">1 (Strongly Disagree)</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5 (Strongly Agree)</option>
							</select>
						</div>
						<div class="carousel-item">
							<h3>
								<strong>Question 7</strong>
							</h3>
							<h4>You learn from other peoples mistakes.</h4>
							<select data-placeholder="" class="form-control-lg" id="q7">
								<option value=""></option>
								<option value="1">1 (Strongly Disagree)</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5 (Strongly Agree)</option>
							</select>
						</div>
						<div class="carousel-item">
							<h3>
								<strong>Question 8</strong>
							</h3>
							<h4>You like to be in your head.</h4>
							<select data-placeholder="" class="form-control-lg" id="q8">
								<option value=""></option>
								<option value="1">1 (Strongly Disagree)</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5 (Strongly Agree)</option>
							</select>
						</div>
						<div class="carousel-item">
							<h3>
								<strong>Question 9</strong>
							</h3>
							<h4>You like the outdoors.</h4>
							<select data-placeholder="" class="form-control-lg" id="q9">
								<option value=""></option>
								<option value="1">1 (Strongly Disagree)</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5 (Strongly Agree)</option>
							</select>
						</div>
						<div class="carousel-item">
							<h3>
								<strong>Question 10</strong>
							</h3>
							<h4>You like to go out and rave.</h4>
							<select data-placeholder="" class="form-control-lg" id="q10">
								<option value=""></option>
								<option value="1">1 (Strongly Disagree)</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5 (Strongly Agree)</option>
							</select>
						</div>
						<div class="carousel-item">
							<button type="submit" class="btn btn-primary btn-lg" id="submit">
								<i class="fa fa-check-circle" aria-hidden="true"></i>
								Get your Match!</button>
						</div>

					</div>
					<a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
						<span class="carousel-control-prev-icon" aria-hidden="true"></span>
						<span class="sr-only">Previous</span>
					</a>
					<a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
						<span class="carousel-control-next-icon" aria-hidden="true"></span>
						<span class="sr-only">Next</span>
					</a>
				</div>
				<!-- QUESTIONS END -->
				<!-- Submit Button
				<button type="submit" class="btn btn-primary btn-lg btn-block" id="submit">
					<i class="fa fa-check-circle" aria-hidden="true"></i>
					Submit</button> -->

				<hr>
				<footer class="footer">
					<div class="container">
						<p>
							<a href="/api/friends">API Friends List</a> |
							<a href="https://github.com/Kyle2099/friend-finder">GitHub Repo</a>
						</p>
					</div>
				</footer>

			</div>

			<!-- Modal -->
			<div id="resultsModal" class="modal" tabindex="-1" role="dialog">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title">Best Match</h5>
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						<div class="modal-body">
							<div class="row">
								<div class="col-md-6">
									<h2 id="yourName"></h2>
									<img id="yourImg" src="#" alt="">
								</div>
								<div class="col-md-6">
									<h2 id="matchName"></h2>
									<img id="matchImg" src="#" alt="">
								</div>
							</div>

						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
						</div>
					</div>

				</div>
			</div>

			<script type="text/javascript">

				// Chosen CSS
				var config = {
					'.chosen-select': {},
					'.chosen-select-deselect': { allow_single_deselect: true },
					'.chosen-select-no-single': { disable_search_threshold: 10 },
					'.chosen-select-no-results': { no_results_text: 'Oops, nothing found!' },
					'.chosen-select-width': { width: "95%" }
				}
				for (var selector in config) {
					$(selector).chosen(config[selector]);
				}


				$("select.form-control-lg").each(function () {
					$(this).on("change",
						function (e) {
							$('.carousel').carousel('next');
						});
				})




				// Capture the form inputs 
				$("#submit").on("click", function () {

					// Form validation
					function validateForm() {
						var isValid = true;
						var parent = null;
						var item;
						$('.form-control-lg').each(function (index) {
							if ($(this).val().trim() === '') {
								isValid = false;
								item = $(this).parents('.carousel-item');
								position = $('.carousel-item').index(item);
								$('.carousel').carousel(position);
								return false;
							}
						});
						
						return isValid;
					}

					// If all required fields are filled
					if (validateForm() == true) {
						// Create an object for the user's data
						var userData = {
							name: $("#name").val().trim(),
							photo: $("#photo").val(),
							scores: [$("#q1").val(), $("#q2").val(), $("#q3").val(), $("#q4").val(), $("#q5").val(), $("#q6").val(), $("#q7").val(), $("#q8").val(), $("#q9").val(), $("#q10").val(),]
						};
						// console.log(userData);

						// Grab the URL of the website
						var currentURL = window.location.origin;

						// AJAX post the data to the friends API. 
						$.post(currentURL + "/api/friends", userData, function (data) {
							const friend = data;

							// Grab the result from the AJAX post so that the best match's name and photo are displayed.
							$("#yourName").text($("#name").val().trim());
							$('#yourImg').attr("src", $("#photo").val());

							$("#matchName").text(friend.name);
							$('#matchImg').attr("src", friend.photo);

							// Show the modal with the best match 
							$("#resultsModal").modal('show');

							// console.log(data);
						});
					} else {
						alert("Please fill out all fields before submitting.");
					}

					return false;
				});
			</script>
		</div>
	</div>
</body>

</html>